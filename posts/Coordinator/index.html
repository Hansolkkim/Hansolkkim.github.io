<!DOCTYPE html><html lang="ko" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.3.1" /><meta property="og:title" content="Coordinator Pattern" /><meta property="og:locale" content="ko" /><meta name="description" content="계기" /><meta property="og:description" content="계기" /><link rel="canonical" href="/posts/Coordinator/" /><meta property="og:url" content="/posts/Coordinator/" /><meta property="og:site_name" content="SoliOS" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-07-25T10:43:10+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Coordinator Pattern" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="nvd2iqjDnkZKbkhCEZILzHaLouk7d4p92EArPFodwzo" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-11-04T16:13:49+09:00","datePublished":"2022-07-25T10:43:10+09:00","description":"계기","headline":"Coordinator Pattern","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/Coordinator/"},"url":"/posts/Coordinator/"}</script><title>Coordinator Pattern | SoliOS</title><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="https://user-images.githubusercontent.com/92504186/175757408-12d2c887-5ba2-4c28-8f9c-80612bb6dbf4.JPEG" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">SoliOS</a></div><div class="site-subtitle font-italic">iOS 개발자를 꿈꿉니다.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/Hansolkkim" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['hskim6521','naver.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Coordinator Pattern</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Coordinator Pattern</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1658713390" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jul 25, 2022 </em> </span> <span> Updated <em class="" data-ts="1667546029" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Nov 4, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> Sol </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1797 words"> <em>9 min</em> read</span></div></div></div><div class="post-content"><h2 id="계기"><span class="mr-2">계기</span><a href="#계기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>토이 프로젝트를 진행하면서, 보다 가벼운 ViewController를 만들 필요성을 느껴 <strong>Coordinator Pattern</strong>을 적용해보고,</p><p>이를 정리하기 위해 포스팅을 작성합니다.</p><h2 id="coordinator-pattern"><span class="mr-2">Coordinator Pattern?</span><a href="#coordinator-pattern" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Coordinator Pattern은 Soroush Khanlou가 2015년에 <a href="https://khanlou.com/2015/01/the-coordinator/" target="_blank">The Coordinator</a>라는 글을 쓰면서 소개가 됐다고 합니다.</p><blockquote><p>One of the biggest problems with the big view controllers is that they entangle your flow logic, view logic, and business logic. - Khanlou</p><p><em>Big(Massive) View Controller의 가장 큰 문제 중 하나는 하나의 flow login, view login, 비즈니스 로직이 얽혀있다는 것이다.</em></p></blockquote><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="kd">func</span> <span class="nf">tableView</span><span class="p">(</span><span class="n">_</span> <span class="nv">tableView</span><span class="p">:</span> <span class="kt">UITableView</span><span class="p">,</span> <span class="n">didSelecteRowAt</span> <span class="nv">indexPath</span><span class="p">:</span> <span class="kt">IndexPath</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">object</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">dataSource</span><span class="p">[</span><span class="n">indexPath</span><span class="p">]</span>
    <span class="k">let</span> <span class="nv">detailViewController</span> <span class="o">=</span> <span class="kt">DetailViewController</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="n">object</span><span class="p">)</span>
    <span class="k">self</span><span class="o">.</span><span class="n">navigationController</span><span class="p">?</span><span class="o">.</span><span class="nf">present</span><span class="p">(</span>
        <span class="n">detailViewController</span><span class="p">,</span>
        <span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> 
        <span class="nv">completion</span><span class="p">:</span> <span class="kc">nil</span>
    <span class="p">)</span>
<span class="p">}</span>
</pre></table></code></div></div><p>위 코드는 TableView에서 Cell이 터치됐을 때 다른 ViewController를 present하는 메소드입니다. 만약 화면이 많은 상황에서 위와 같은 코드가 존재하게 된다면, 해당 뷰는 재사용할 수 없게 되고, View 객체가 flow logic을 갖게 되어 View 객체의 역할을 벗어나게 됩니다.</p><p>위 메소드를 가지고 있는 ViewController는 다음에 어떤 ViewController를 호출하고 보여줄 것인지에 대한 flow logic을 알고 있게 되고, 4번째 줄에서는 심지어 부모 ViewController에게 해야하는 일에 대한 <u>정확한</u> 메세지를 보내 지시하고 있습니다.</p><p>더 큰 문제는, 이런 다음 단계에 대한 flow logic만을 갖고있는 ViewController가 여러 개 있을 수 있다는 것입니다.</p><p>Khanlou는 이런 문제를 해결하기 위해 ViewController를 더 높은 수준의 객체가 관리하게 되면 많은 이점을 가질 수 있음을 알게 됐고, 이 객체를 <strong>Coordinator</strong>라고 부르기로 했습니다.</p><p>즉, Coordinator라는 객체로 ViewController를 소유, 관리하여, <strong>ViewController들 간의 결합도를 낮춰</strong>주도록 하는 것입니다.</p><p>ViewController들은 이전에 어떤 VC가 있었고, 다음에 어떤 VC가 올 지 알 필요가 없고, 이런 flow logic을 Coordinator 객체가 관리해줍니다.</p><p>이렇게 되면 어떤 순서로도 ViewController 전환이 가능해져 ViewController의 재사용이 가능해집니다.</p><h2 id="coordinator-pattern-사용해보기"><span class="mr-2">Coordinator Pattern 사용해보기</span><a href="#coordinator-pattern-사용해보기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Coordinator Pattern을 활용해 HomeViewController에서 포인트 충전 버튼을 눌렀을 때, 등록된 카드가 있다면 포인트 충전 화면으로, 등록된 카드가 없다면 카드 등록 화면으로 이동하는 앱을 간단하게 만들어보도록 하겠습니다.</p><ul><li>만들고자 하는 앱의 구조는 아래와 같습니다.</ul><p><img data-src="https://raw.githubusercontent.com/Hansolkkim/Image-Upload/forUpload/img/202210261729371.png" alt="image-20221026172952150" style="zoom:50%;" data-proofer-ignore></p><h4 id="1-coordinator-protocol-만들기"><span class="mr-2">1. Coordinator Protocol 만들기</span><a href="#1-coordinator-protocol-만들기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>먼저, 화면 전환을 위한 Coordinator 객체의 protocol을 만듭니다.</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="kd">protocol</span> <span class="kt">Coordinator</span><span class="p">:</span> <span class="kt">AnyObject</span> <span class="p">{</span>

    <span class="k">var</span> <span class="nv">childrenCoordinator</span><span class="p">:</span> <span class="p">[</span><span class="kt">Coordinator</span><span class="p">]</span> <span class="p">{</span> <span class="k">get</span> <span class="p">}</span>
    <span class="k">var</span> <span class="nv">navigationController</span><span class="p">:</span> <span class="kt">UINavigationController</span> <span class="p">{</span> <span class="k">get</span> <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">start</span><span class="p">()</span>
<span class="p">}</span>
</pre></table></code></div></div><ol><li>부모 자식 관계를 가지는 Coordinator를 설계하기 떄문에 childrenCoordinator 프로퍼티를 추가합니다.<li>Coodinator는 화면 전환시 기준이 되는 NavigationController를 소유합니다.<li>부모 Coordinator가 자식 Coordinator를 생성하고 자식 Coordinator의 첫 화면을 띄우기 위해 <code class="language-plaintext highlighter-rouge">start()</code> 메소드를 가집니다.</ol><h4 id="2-appcoordinator-만들기"><span class="mr-2">2. AppCoordinator 만들기</span><a href="#2-appcoordinator-만들기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>위에서 만든 <code class="language-plaintext highlighter-rouge">Coordinator</code> 프로토콜을 채택하는 AppCoordinator를 만듭니다.</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="kd">class</span> <span class="kt">AppCoordinator</span><span class="p">:</span> <span class="kt">Coordinator</span> <span class="p">{</span>

    <span class="k">var</span> <span class="nv">childrenCoordinator</span><span class="p">:</span> <span class="p">[</span><span class="kt">Coordinator</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="k">let</span> <span class="nv">navigationController</span><span class="p">:</span> <span class="kt">UINavigationController</span>

    <span class="nf">init</span><span class="p">(</span><span class="nv">navigationController</span><span class="p">:</span> <span class="kt">UINavigationController</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">navigationController</span> <span class="o">=</span> <span class="n">navigationController</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">start</span><span class="p">()</span> <span class="p">{</span>
        <span class="nf">showHomeViewController</span><span class="p">()</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">private</span> <span class="kd">extension</span> <span class="kt">AppCoordinator</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">showHomeViewController</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">homeCoordinator</span> <span class="o">=</span> <span class="kt">HomeCoordinator</span><span class="p">(</span><span class="nv">navigationController</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">navigationController</span><span class="p">)</span>
        <span class="n">childrenCoordinator</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="n">coordinator</span><span class="p">)</span>
        <span class="n">coordinator</span><span class="o">.</span><span class="nf">start</span><span class="p">()</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><h3 id="3-homecoordinator-만들기"><span class="mr-2">3. HomeCoordinator 만들기</span><a href="#3-homecoordinator-만들기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>AppCoordinator는 앱의 전체적인 Coordination을 관장(*)하는 Coordinator라고 가정하고,</p><p>HomeCoordinator 또한 만들어 줍니다.</p><p><sub>(*: 여기서는 생략됐지만 로그인 기능이 있다면 LoginCoordinator/ HomeCoordinator로 분기하는 등의 기능을 하는 Coordinator로 사용한다는 뜻입니다.)</sub></p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="kd">class</span> <span class="kt">HomeCoordinator</span><span class="p">:</span> <span class="kt">Coordinator</span> <span class="p">{</span>
    <span class="c1">// 다른 구현 내용은 생략합니다.</span>
    <span class="kd">func</span> <span class="nf">start</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">homeViewController</span> <span class="o">=</span> <span class="kt">HomeViewController</span><span class="p">(</span><span class="nv">navigation</span><span class="p">:</span> <span class="k">self</span><span class="p">)</span>
        <span class="n">navigationController</span><span class="o">.</span><span class="nf">pushViewController</span><span class="p">(</span><span class="n">viewController</span><span class="p">,</span> <span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><h3 id="4-homeviewcontroller-만들기"><span class="mr-2">4. HomeViewController 만들기</span><a href="#4-homeviewcontroller-만들기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>이제 Top-up Button이 있는 <strong>HomeViewController</strong>를 만들어줄 차례입니다.</p><p>HomeViewController는 Top-up Button이 눌렸음을 HomeCoordinator에게 알리고,</p><p>HomeViewController는 해당 노티를 이용해 다음에 어떤 ViewController를 보여줄지 결정합니다.</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="kd">protocol</span> <span class="kt">HomeNavigation</span><span class="p">:</span> <span class="kt">AnyObject</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">topupButtonDidTap</span><span class="p">()</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="kt">HomeViewController</span><span class="p">:</span> <span class="kt">UIViewController</span> <span class="p">{</span>
    
    <span class="kd">private</span> <span class="kd">lazy</span> <span class="k">var</span> <span class="nv">topupButton</span><span class="p">:</span> <span class="kt">UIButton</span> <span class="o">=</span> <span class="p">{</span>
        <span class="o">...</span>
        <span class="k">let</span> <span class="nv">button</span> <span class="o">=</span> <span class="kt">UIButton</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
        <span class="n">button</span><span class="o">.</span><span class="nf">addTarget</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="nv">action</span><span class="p">:</span> <span class="kd">#selector(</span><span class="nf">topupButtonDidTap</span><span class="kd">)</span><span class="p">,</span> <span class="nv">for</span><span class="p">:</span> <span class="o">.</span><span class="n">touchUpInside</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">button</span>
    <span class="p">}()</span>

    <span class="kd">private</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">coordinator</span><span class="p">:</span> <span class="kt">HomeNavigation</span><span class="p">?</span>

    <span class="o">...</span>
	
    <span class="kd">@objc</span>
    <span class="kd">private</span> <span class="kd">func</span> <span class="nf">topupButtonDidTap</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">coordinator</span><span class="p">?</span><span class="o">.</span><span class="nf">topupButtonDidTap</span><span class="p">()</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>여기서 <strong>HomeNavigation</strong>이라는 프로토콜을 사용했습니다.</p><p>HomeViewController가 자신의 Coordinator에게 특정 노티를 보내주기 위해 Coordinator를 알고 있어야 하지만</p><p>Coordinator의 모든 부분을 알 필요는 없고, 노티를 위한 메소드 정도만 알고 있도록 하기 위해 해당 프로토콜을 사용했습니다.</p><p>이제 HomeNavigation 프로토콜을 HomeCoordinator가 채택하도록 하여 화면 전환 플로우를 완성합니다.</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="kd">class</span> <span class="kt">HomeCoordinator</span><span class="p">:</span> <span class="kt">Coordinator</span> <span class="p">{</span>

    <span class="kd">private</span> <span class="k">var</span> <span class="nv">paymentMethodsList</span><span class="p">:</span> <span class="p">[</span><span class="kt">PaymentMethod</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1">// 다른 구현 내용은 생략합니다.</span>
<span class="p">}</span>

<span class="kd">extension</span> <span class="kt">HomeCoordinator</span><span class="p">:</span> <span class="kt">HomeNavigation</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">topupButtonDidTap</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">isPaymentMethodsListEmpty</span> <span class="o">=</span> <span class="n">paymentMethodsList</span><span class="o">.</span><span class="n">isEmpty</span>

        <span class="k">if</span> <span class="n">isPaymentMethodsListEmpty</span> <span class="p">{</span>
            <span class="nf">showAddPaymentMethodViewController</span><span class="p">()</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nf">showTopupViewController</span><span class="p">()</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">private</span> <span class="kd">extension</span> <span class="kt">HomeCoordinator</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">showAddPaymentMethodViewController</span><span class="p">()</span> <span class="p">{</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">showTopupViewController</span><span class="p">()</span> <span class="p">{</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>그리고 앱이 시작될 때에 AppCoordinator를 실행시켜주고, AppCoordinator에 대한 참조를 유지하기 위해</p><p>SceneDelegate를 아래와 같이 설정합니다.</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="kd">class</span> <span class="kt">SceneDelegate</span><span class="p">:</span> <span class="kt">UIResponder</span><span class="p">,</span> <span class="kt">UIWindowSceneDelegate</span> <span class="p">{</span>

    <span class="k">var</span> <span class="nv">window</span><span class="p">:</span> <span class="kt">UIWindow</span><span class="p">?</span>
    <span class="kd">private</span> <span class="k">var</span> <span class="nv">appCoordinator</span><span class="p">:</span> <span class="kt">Coordinator</span><span class="p">?</span>

    <span class="kd">func</span> <span class="nf">scene</span><span class="p">(</span><span class="n">_</span> <span class="nv">scene</span><span class="p">:</span> <span class="kt">UIScene</span><span class="p">,</span> <span class="n">willConnectTo</span> <span class="nv">session</span><span class="p">:</span> <span class="kt">UISceneSession</span><span class="p">,</span> <span class="n">options</span> <span class="nv">connectionOptions</span><span class="p">:</span> <span class="kt">UIScene</span><span class="o">.</span><span class="kt">ConnectionOptions</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">windowScene</span> <span class="o">=</span> <span class="p">(</span><span class="n">scene</span> <span class="k">as?</span> <span class="kt">UIWindowScene</span><span class="p">)</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>

        <span class="k">let</span> <span class="nv">window</span> <span class="o">=</span> <span class="kt">UIWindow</span><span class="p">(</span><span class="nv">windowScene</span><span class="p">:</span> <span class="n">windowScene</span><span class="p">)</span>
        <span class="k">self</span><span class="o">.</span><span class="n">window</span> <span class="o">=</span> <span class="n">window</span>

        <span class="k">let</span> <span class="nv">navigationController</span> <span class="o">=</span> <span class="kt">UINavigationController</span><span class="p">()</span>
        <span class="k">self</span><span class="o">.</span><span class="n">window</span><span class="p">?</span><span class="o">.</span><span class="n">rootViewController</span> <span class="o">=</span> <span class="n">navigationController</span>

        <span class="k">self</span><span class="o">.</span><span class="n">appCoordinator</span> <span class="o">=</span> <span class="kt">AppCoordinator</span><span class="p">(</span><span class="nv">navigationController</span><span class="p">:</span> <span class="n">navigationController</span><span class="p">)</span>
        <span class="n">appCoordinator</span><span class="p">?</span><span class="o">.</span><span class="nf">start</span><span class="p">()</span>

        <span class="k">self</span><span class="o">.</span><span class="n">window</span><span class="p">?</span><span class="o">.</span><span class="nf">makeKeyAndVisible</span><span class="p">()</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><h3 id="5-동작-화면"><span class="mr-2">5. 동작 화면</span><a href="#5-동작-화면" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="table-wrapper"><table><thead><tr><th style="text-align: center">등록된 카드가 존재할 때<th style="text-align: center">등록된 카드가 존재하지 않을 때<tbody><tr><td style="text-align: center"><img data-src="https://raw.githubusercontent.com/Hansolkkim/Image-Upload/forUpload/img/202210261624159.gif" alt="SS2022-10-26PM04.23.08" data-proofer-ignore><td style="text-align: center"><img data-src="https://raw.githubusercontent.com/Hansolkkim/Image-Upload/forUpload/img/202210261625922.gif" alt="SS2022-10-26PM04.24.38" data-proofer-ignore></table></div><p><a href="https://gist.github.com/Hansolkkim/4391e39bd72e7edb696f0f2cbf9b42ef" target="_blank">[전체 코드 확인]</a></p><h2 id="더-생각해봐야할-점"><span class="mr-2">더 생각해봐야할 점?</span><a href="#더-생각해봐야할-점" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>토이 프로젝트에 Coordinator 패턴을 적용하다보니 생각해볼 부분이 있었습니다.</p><p>가장 큰 부분은 <strong><u>Coordinator를 나누는 기준을 무엇으로 할 것인가?</u></strong> 에 대한 의문이었습니다.</p><p>같이 공부하는 지인들과 토론해본 결과, <u>"뒤로 가기"가 필요하고, "뒤로 가기"의미가 있는 범위의 ViewController 들끼리 하나의 Coordinator에 소속되어 있는게 적절하지 않을까</u> 하는 결론을 내렸습니다.</p><p>일례로, 구현하진 않았지만 앞서 말했던 내용처럼, 만약 <strong>로그인 뷰</strong>가 있고 <strong>홈 뷰</strong>가 있다면 홈 뷰에서 로그인 뷰로 “뒤로 가기”가 필요하지 않고 의미가 있지 않은 범위의 관계이기 때문에 같은 Coordinator에 속할 필요가 없는 뷰들이라고 생각되었습니다.</p><h3 id="참고자료"><span class="mr-2">참고자료</span><a href="#참고자료" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ol><li><p><a href="https://khanlou.com/2015/01/the-coordinator/">[Khanlau - The Coordinator]</a></p><li><p><a href="https://saad-eloulladi.medium.com/ios-coordinator-pattern-in-swift-39a15aa3b01b">[iOS: Coordinator Pattern in Swift]</a></p></ol></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ios/'>iOS</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/ios/" class="post-tag no-text-decoration" >iOS</a> <a href="/tags/design-pattern/" class="post-tag no-text-decoration" >Design Pattern</a> <a href="/tags/coordinator-pattern/" class="post-tag no-text-decoration" >Coordinator Pattern</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Coordinator+Pattern+-+SoliOS&url=%2Fposts%2FCoordinator%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Coordinator+Pattern+-+SoliOS&u=%2Fposts%2FCoordinator%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=%2Fposts%2FCoordinator%2F&text=Coordinator+Pattern+-+SoliOS" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div><script src="https://utteranc.es/client.js" repo="Hansolkkim/Hansolkkim.github.io" issue-term="pathname" theme="github-light" crossorigin="anonymous" async> </script> </script></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Coordinator/">Coordinator Pattern</a><li><a href="/posts/CGAffineTransform/">CGAffineTransform에 대해</a><li><a href="/posts/CollectionViewInCollectionView-1/">CollectionView 안에 CollectionView 넣기 - (1)</a><li><a href="/posts/ViewLayout/">iOS의 Layout</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ios/">iOS</a> <a class="post-tag" href="/tags/collectionview/">CollectionView</a> <a class="post-tag" href="/tags/dynamic/">dynamic</a> <a class="post-tag" href="/tags/cgaffinetransform/">CGAffineTransform</a> <a class="post-tag" href="/tags/coordinator-pattern/">Coordinator Pattern</a> <a class="post-tag" href="/tags/design-pattern/">Design Pattern</a> <a class="post-tag" href="/tags/layout/">Layout</a> <a class="post-tag" href="/tags/roundedlabel/">roundedLabel</a> <a class="post-tag" href="/tags/string-size/">String.size</a> <a class="post-tag" href="/tags/uicollectionview/">UICollectionView</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/CollectionViewInCollectionView-1/"><div class="card-body"> <em class="small" data-ts="1656333480" data-df="ll" > Jun 27, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CollectionView 안에 CollectionView 넣기 - (1)</h3><div class="text-muted small"><p> 1. 계기 코드스쿼드 마지막 팀 프로젝트인 Issue Tracker를 진행하다가, CollectionView(Issue Cell)안에 CollectionView(Label Cell)이 있으면 편하게 구현할 수 있겠다고 생각했습니다. 하지만 편할 것이라는 생각과는 다르게, 처음 해보다보니 이 두 CollectionVIew의 DataSource를 관리...</p></div></div></a></div><div class="card"> <a href="/posts/CollectionViewInCollectionView-2/"><div class="card-body"> <em class="small" data-ts="1656338640" data-df="ll" > Jun 27, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CollectionView 안에 CollectionView 넣기 - (2)</h3><div class="text-muted small"><p> (앞서 작성했던 1편에 이어 작성되었습니다.) 4. 문제 해결 3. IssueCollectionCell의 dynamic height 하지만, Issue들 중에 Label을 가지지 않은 Issue들도 있을텐데, 이런 Issue들의 Cell의 높이는 작아져야 하지 않을까? 하는 생각에서 3번째 문제 해결을 해보고자 합니다! 현재 상황에서, Labe...</p></div></div></a></div><div class="card"> <a href="/posts/ViewLayout/"><div class="card-body"> <em class="small" data-ts="1656592980" data-df="ll" > Jun 30, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>iOS의 Layout</h3><div class="text-muted small"><p> 계기 UITableView는 Cell의 Subview들의 Constraints만 잘 잡아주면 Cell의 높이가 동적으로 설정되는 기능을 이용하려 했습니다. 그런데 아무리해도 Cell의 높이는 45 point로 그대로였고, 이거 떄문에 2시간동안 Constraints만 엄청 수정했습니다.. 포기하고 자려고 하다가, 자기 직전에 요즘 버릇인 UIVi...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/ViewLayout/" class="btn btn-outline-primary" prompt="Older"><p>iOS의 Layout</p></a> <a href="/posts/CGAffineTransform/" class="btn btn-outline-primary" prompt="Newer"><p>CGAffineTransform에 대해</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2022 <a href="">Sol</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ios/">iOS</a> <a class="post-tag" href="/tags/collectionview/">CollectionView</a> <a class="post-tag" href="/tags/dynamic/">dynamic</a> <a class="post-tag" href="/tags/cgaffinetransform/">CGAffineTransform</a> <a class="post-tag" href="/tags/coordinator-pattern/">Coordinator Pattern</a> <a class="post-tag" href="/tags/design-pattern/">Design Pattern</a> <a class="post-tag" href="/tags/layout/">Layout</a> <a class="post-tag" href="/tags/roundedlabel/">roundedLabel</a> <a class="post-tag" href="/tags/string-size/">String.size</a> <a class="post-tag" href="/tags/uicollectionview/">UICollectionView</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/ko.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
